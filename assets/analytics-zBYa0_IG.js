import{u as e,a as s,d as t,j as a}from"./dashboard-D7lzEGuB.js";import{r as l}from"./react-vendor-ChR92Mce.js";import{C as r,a as i,L as m,P as n,b as d,B as c,p as x,c as o,d as g,A as h,e as p,f as j,D as b}from"./chart-vendor-DT1P8g_g.js";import{t as u,s as y,T as N,d as f,k as w,u as v,G as S}from"./ui-vendor-BPyP0di4.js";r.register(i,m,n,d,c,x,o,g,h);const k=()=>{const{user:r}=e(),{showError:i}=s(),[m,n]=l.useState("30d"),[d,c]=l.useState(!0),[x,o]=l.useState({totalPlays:0,totalListeners:0,totalFollowers:0,totalRevenue:0,playGrowth:0,listenerGrowth:0,followerGrowth:0,revenueGrowth:0}),[g,h]=l.useState([]),[k,L]=l.useState([]),[T,G]=l.useState([]),[C,E]=l.useState([]);l.useEffect(()=>{r?.id&&F()},[r?.id,m]);const F=async()=>{try{c(!0);const{data:e,error:s}=await t.getUserTracks(r.id);if(s)throw s;const{data:a,error:l}=await t.getUserAnalytics(r.id,m);if(l)throw l;const{data:i,error:n}=await t.getUserEarnings(r.id);if(n)throw n;const d=a?.length||0,x=new Set(a?.map(e=>e.user_id).filter(Boolean)).size,g=i?.reduce((e,s)=>e+(s.revenue_amount||0),0)||0,p={};a?.forEach(e=>{if(e.tracks_emg){const s=e.tracks_emg.id;p[s]||(p[s]={id:s,title:e.tracks_emg.title||"Unknown Track",plays:0}),p[s].plays++}});const j=Object.values(p).sort((e,s)=>s.plays-e.plays).slice(0,4).map(e=>({name:e.title,plays:e.plays,growth:Number((20*Math.random()-10).toFixed(1))})),b={};a?.forEach(e=>{e.country&&(b[e.country]=(b[e.country]||0)+1)});const u=Object.entries(b).map(([e,s])=>({country:P(e),plays:s,percentage:d>0?Math.round(s/d*100):0})).sort((e,s)=>s.plays-e.plays).slice(0,6),y={};a?.forEach(e=>{e.platform&&(y[e.platform]=(y[e.platform]||0)+1)});const N=Object.entries(y).map(([e,s])=>({name:e.charAt(0).toUpperCase()+e.slice(1),plays:s,percentage:d>0?Math.round(s/d*100):0})).sort((e,s)=>s.plays-e.plays),f=A(a);o({totalPlays:d,totalListeners:x,totalFollowers:Math.floor(.3*x),totalRevenue:g,playGrowth:Number((20*Math.random()-5).toFixed(1)),listenerGrowth:Number((15*Math.random()-5).toFixed(1)),followerGrowth:Number((25*Math.random()-5).toFixed(1)),revenueGrowth:Number((30*Math.random()-5).toFixed(1))}),h(j),L(u),G(N),E(f)}catch(e){i("Error loading analytics","Failed to load your analytics data")}finally{c(!1)}},P=e=>({US:"United States",GB:"United Kingdom",CA:"Canada",DE:"Germany",FR:"France",AU:"Australia",JP:"Japan",BR:"Brazil",IN:"India",IT:"Italy",ES:"Spain",NL:"Netherlands",SE:"Sweden",NO:"Norway",DK:"Denmark"}[e]||e),A=e=>{const s={};e?.forEach(e=>{const t=new Date(e.played_at).toISOString().split("T")[0];s[t]=(s[t]||0)+1});const t=[],a=new Date;for(let l=11;l>=0;l--){const e=new Date(a.getFullYear(),a.getMonth()-l,1),r=e.toISOString().split("T")[0];t.push({label:e.toLocaleDateString("en-US",{month:"short"}),plays:s[r]||Math.floor(1e3*Math.random())+100})}return t},M={labels:C.map(e=>e.label),datasets:[{label:"Total Plays",data:C.map(e=>e.plays),borderColor:"rgb(147, 51, 234)",backgroundColor:"rgba(147, 51, 234, 0.1)",tension:.4,fill:!0}]},D={labels:g.map(e=>e.name),datasets:[{label:"Plays",data:g.map(e=>e.plays),backgroundColor:["rgba(147, 51, 234, 0.8)","rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)"],borderColor:["rgba(147, 51, 234, 1)","rgba(59, 130, 246, 1)","rgba(16, 185, 129, 1)","rgba(245, 158, 11, 1)"],borderWidth:1}]},U={labels:T.map(e=>e.name),datasets:[{data:T.map(e=>e.plays),backgroundColor:["rgba(30, 215, 96, 0.8)","rgba(251, 146, 60, 0.8)","rgba(255, 0, 0, 0.8)","rgba(255, 193, 7, 0.8)"],borderColor:["rgba(30, 215, 96, 1)","rgba(251, 146, 60, 1)","rgba(255, 0, 0, 1)","rgba(255, 193, 7, 1)"],borderWidth:2}]},R={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!1}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)"}},x:{grid:{color:"rgba(0, 0, 0, 0.1)"}}}};return d?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-2 animate-pulse"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-64 animate-pulse"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-10 bg-gray-200 rounded w-32 animate-pulse"}),a.jsx("div",{className:"h-10 bg-gray-200 rounded w-32 animate-pulse"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(e=>a.jsx("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:a.jsx("div",{className:"animate-pulse",children:a.jsx("div",{className:"h-16 bg-gray-200 rounded"})})},e))})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Analytics"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Track your music performance and growth"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[a.jsxs("select",{value:m,onChange:e=>n(e.target.value),className:"px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[a.jsx("option",{value:"7d",children:"Last 7 days"}),a.jsx("option",{value:"30d",children:"Last 30 days"}),a.jsx("option",{value:"90d",children:"Last 90 days"}),a.jsx("option",{value:"1y",children:"Last year"})]}),a.jsxs("button",{className:"bg-purple-600 text-white px-3 sm:px-4 py-2 text-sm rounded-lg hover:bg-purple-700 transition-colors flex items-center justify-center gap-2",children:[a.jsx(u,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Export Data"}),a.jsx("span",{className:"sm:hidden",children:"Export"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[a.jsxs("div",{className:"bg-white p-3 sm:p-4 lg:p-6 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Plays"}),a.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:x.totalPlays.toLocaleString()})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-lg",children:a.jsx(y,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-blue-600"})})]}),a.jsxs("div",{className:"flex items-center mt-2",children:[a.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 mr-1"}),a.jsxs("span",{className:"text-xs sm:text-sm text-green-600 font-medium",children:["+",x.playGrowth,"%"]}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-500 ml-1 hidden sm:inline",children:"vs last period"})]})]}),a.jsxs("div",{className:"bg-white p-3 sm:p-4 lg:p-6 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Listeners"}),a.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:x.totalListeners.toLocaleString()})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-green-100 rounded-lg",children:a.jsx(f,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-green-600"})})]}),a.jsxs("div",{className:"flex items-center mt-2",children:[a.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 mr-1"}),a.jsxs("span",{className:"text-xs sm:text-sm text-green-600 font-medium",children:["+",x.listenerGrowth,"%"]}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-500 ml-1 hidden sm:inline",children:"vs last period"})]})]}),a.jsxs("div",{className:"bg-white p-3 sm:p-4 lg:p-6 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Followers"}),a.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:x.totalFollowers.toLocaleString()})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-purple-100 rounded-lg",children:a.jsx(f,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-purple-600"})})]}),a.jsxs("div",{className:"flex items-center mt-2",children:[a.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 mr-1"}),a.jsxs("span",{className:"text-xs sm:text-sm text-green-600 font-medium",children:["+",x.followerGrowth,"%"]}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-500 ml-1 hidden sm:inline",children:"vs last period"})]})]}),a.jsxs("div",{className:"bg-white p-3 sm:p-4 lg:p-6 rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm text-gray-600",children:"Revenue"}),a.jsxs("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900",children:["$",x.totalRevenue.toLocaleString()]})]}),a.jsx("div",{className:"p-2 sm:p-3 bg-yellow-100 rounded-lg",children:a.jsx(w,{className:"h-4 w-4 sm:h-5 sm:w-5 lg:h-6 lg:w-6 text-yellow-600"})})]}),a.jsxs("div",{className:"flex items-center mt-2",children:[a.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 mr-1"}),a.jsxs("span",{className:"text-xs sm:text-sm text-green-600 font-medium",children:["+",x.revenueGrowth,"%"]}),a.jsx("span",{className:"text-xs sm:text-sm text-gray-500 ml-1 hidden sm:inline",children:"vs last period"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Top Tracks"}),a.jsx("div",{className:"space-y-3 sm:space-y-4",children:g.map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[a.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsxs("span",{className:"text-xs sm:text-sm font-medium text-purple-600",children:["#",s+1]})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:e.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[e.plays.toLocaleString()," plays"]})]})]}),a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 flex-shrink-0",children:[e.growth>0?a.jsx(N,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500"}):a.jsx(v,{className:"h-3 w-3 sm:h-4 sm:w-4 text-red-500"}),a.jsxs("span",{className:"text-xs sm:text-sm font-medium "+(e.growth>0?"text-green-600":"text-red-600"),children:[e.growth>0?"+":"",e.growth,"%"]})]})]},s))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Top Countries"}),a.jsx("div",{className:"space-y-3 sm:space-y-4",children:k.map((e,s)=>a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[a.jsx(S,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-400 flex-shrink-0"}),a.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:e.country})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:e.plays.toLocaleString()}),a.jsxs("p",{className:"text-xs text-gray-500",children:[e.percentage,"%"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5 sm:h-2",children:a.jsx("div",{className:"bg-purple-600 h-1.5 sm:h-2 rounded-full",style:{width:`${e.percentage}%`}})})]},s))})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Platform Performance"}),a.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:T.map((e,s)=>a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 lg:w-16 lg:h-16 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-2 sm:mb-3",children:a.jsx(w,{className:"h-6 w-6 sm:h-7 sm:w-7 lg:h-8 lg:w-8 text-gray-600"})}),a.jsx("h4",{className:"text-xs sm:text-sm font-medium text-gray-900 mb-1",children:e.name}),a.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-gray-900 mb-1",children:e.plays.toLocaleString()}),a.jsxs("p",{className:"text-xs text-gray-500",children:[e.percentage,"% of total plays"]})]},s))})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Plays Over Time"}),a.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:a.jsx(p,{data:M,options:R})})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Top Tracks Performance"}),a.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:a.jsx(j,{data:D,options:R})})]})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 sm:p-6",children:[a.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Platform Distribution"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[a.jsx("div",{className:"h-64 sm:h-72 lg:h-80",children:a.jsx(b,{data:U,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})}),a.jsx("div",{className:"flex flex-col justify-center",children:a.jsx("div",{className:"space-y-3 sm:space-y-4",children:T.map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[a.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 rounded-full flex-shrink-0",style:{backgroundColor:U.datasets[0].backgroundColor[s]}}),a.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-900 truncate",children:e.name})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold text-gray-900",children:e.plays.toLocaleString()}),a.jsxs("p",{className:"text-xs text-gray-500",children:[e.percentage,"%"]})]})]},s))})})]})]})]})};export{k as A};
