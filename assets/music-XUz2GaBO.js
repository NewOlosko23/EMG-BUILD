import{u as e,a as s,j as t,d as a,f as r}from"./dashboard-D7lzEGuB.js";import{r as l,L as i}from"./react-vendor-ChR92Mce.js";import{Q as c,M as n,t as d,O as o,$ as x,a0 as m,s as p,a1 as u,f as g,a2 as h,a3 as j,T as b,J as y,a4 as f,a5 as N,V as v,a as w,a6 as k,c as C,X as D,a7 as S,a8 as F,U as A}from"./ui-vendor-BPyP0di4.js";const T=()=>{const{user:r}=e(),{showToast:w}=s(),[k,C]=l.useState(""),[D,S]=l.useState("all"),[F,A]=l.useState("date"),[T,P]=l.useState("desc"),[U,L]=l.useState([]),[M,E]=l.useState("table"),[$,R]=l.useState(!1),[_,G]=l.useState([]),[z,q]=l.useState(!0),[B,O]=l.useState({totalTracks:0,totalPlays:0,followers:0,monthlyPlays:0});l.useEffect(()=>{(async()=>{if(r){q(!0);try{const{data:e,error:s}=await a.getUserTracks(r.id);if(s)throw new Error(s.message);const t=e?.map(e=>({id:e.id,title:e.title,artist:e.artist,duration:e.duration?Y(e.duration):"0:00",plays:e.play_count||0,status:"approved"===e.status?"Live":"pending"===e.status?"Pending":"Rejected",genre:e.genre,releaseDate:e.release_date||e.created_at,platforms:e.platforms||[],audioUrl:e.audio_url,coverArtUrl:e.cover_art_url,description:e.description,tags:e.tags||[],explicit:e.explicit||!1}))||[];G(t);const l=t.reduce((e,s)=>e+(s.plays||0),0),i=t.reduce((e,s)=>{const t=new Date(s.releaseDate),a=new Date;return t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()?e+(s.plays||0):e},0);O({totalTracks:t.length,totalPlays:l,followers:0,monthlyPlays:i})}catch(e){w("Failed to load tracks","error")}finally{q(!1)}}})()},[r,w]);const Y=e=>`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`,H=_.filter(e=>{const s=e.title.toLowerCase().includes(k.toLowerCase())||e.genre.toLowerCase().includes(k.toLowerCase())||e.artist.toLowerCase().includes(k.toLowerCase()),t="all"===D||e.genre===D;return s&&t}).sort((e,s)=>{let t,a;switch(F){case"title":default:t=e.title.toLowerCase(),a=s.title.toLowerCase();break;case"plays":t=e.plays,a=s.plays;break;case"date":t=new Date(e.releaseDate),a=new Date(s.releaseDate);break;case"duration":t=e.duration,a=s.duration}return"asc"===T?t>a?1:-1:t<a?1:-1}),I=e=>{L(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},J=()=>{L(U.length===H.length?[]:H.map(e=>e.id))};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Music"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your tracks and releases"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>E("table"===M?"grid":"table"),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"table"===M?t.jsx(c,{className:"h-4 w-4"}):t.jsx(n,{className:"h-4 w-4"})}),t.jsx("button",{onClick:()=>R(!$),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:t.jsx(d,{className:"h-4 w-4"})})]}),t.jsxs(i,{to:"/dashboard/upload",className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm sm:text-base",children:[t.jsx(n,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Upload New Track"}),t.jsx("span",{className:"sm:hidden",children:"Upload"})]})]})]}),t.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsxs("div",{className:"relative",children:[t.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),t.jsx("input",{type:"text",value:k,onChange:e=>C(e.target.value),placeholder:"Search tracks by title or genre...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[t.jsx("select",{value:D,onChange:e=>S(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:["all","Electronic","Ambient","Synthwave","House","Techno","Pop","Rock","Gospel"].map(e=>t.jsx("option",{value:e,children:"all"===e?"All Genres":e},e))}),t.jsxs("select",{value:F,onChange:e=>A(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[t.jsx("option",{value:"date",children:"Sort by Date"}),t.jsx("option",{value:"title",children:"Sort by Title"}),t.jsx("option",{value:"plays",children:"Sort by Plays"}),t.jsx("option",{value:"duration",children:"Sort by Duration"})]}),t.jsx("button",{onClick:()=>P("asc"===T?"desc":"asc"),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center justify-center",children:"asc"===T?t.jsx(x,{className:"h-4 w-4"}):t.jsx(m,{className:"h-4 w-4"})})]})]})}),U.length>0&&t.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-sm font-medium text-purple-900",children:[U.length," track",U.length>1?"s":""," selected"]}),t.jsx("button",{onClick:J,className:"text-sm text-purple-600 hover:text-purple-700",children:U.length===H.length?"Deselect All":"Select All"})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("button",{onClick:()=>{},className:"px-3 py-1 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Download"}),t.jsx("button",{onClick:()=>{},className:"px-3 py-1 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Share"}),t.jsx("button",{onClick:()=>{},className:"px-3 py-1 text-sm bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete"})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:t.jsx(n,{className:"h-5 w-5 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Total Tracks"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:B.totalTracks})]})]})}),t.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:t.jsx(p,{className:"h-5 w-5 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Total Plays"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:B.totalPlays.toLocaleString()})]})]})}),t.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:t.jsx(u,{className:"h-5 w-5 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Followers"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:B.followers.toLocaleString()})]})]})}),t.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:t.jsx(g,{className:"h-5 w-5 text-yellow-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"This Month"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:B.monthlyPlays.toLocaleString()})]})]})})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[t.jsx("div",{className:"p-4 border-b border-gray-200",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Your Tracks (",H.length,")"]}),t.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:t.jsxs("span",{children:["Showing ",H.length," of ",_.length," tracks"]})})]})}),t.jsx("div",{className:"overflow-x-auto",children:z?t.jsxs("div",{className:"flex items-center justify-center py-12",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),t.jsx("span",{className:"ml-2 text-gray-600",children:"Loading tracks..."})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"hidden lg:block",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t.jsxs("button",{onClick:J,className:"flex items-center gap-2 hover:text-gray-700",children:[U.length===H.length?t.jsx(h,{className:"h-4 w-4 text-purple-600"}):t.jsx(j,{className:"h-4 w-4"}),"Track"]})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Genre"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plays"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Release Date"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:H.map(e=>t.jsxs("tr",{className:"hover:bg-gray-50 "+(U.includes(e.id)?"bg-purple-50":""),children:[t.jsx("td",{className:"px-4 py-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>I(e.id),className:"flex-shrink-0",children:U.includes(e.id)?t.jsx(h,{className:"h-4 w-4 text-purple-600"}):t.jsx(j,{className:"h-4 w-4 text-gray-400"})}),t.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:t.jsx(n,{className:"h-5 w-5 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.title}),t.jsx("p",{className:"text-sm text-gray-500",children:e.artist})]})]})}),t.jsx("td",{className:"px-4 py-4",children:t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.genre})}),t.jsx("td",{className:"px-4 py-4 text-sm text-gray-900",children:e.duration}),t.jsx("td",{className:"px-4 py-4",children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(b,{className:"h-3 w-3 text-green-500"}),t.jsx("span",{className:"text-sm text-gray-900",children:e.plays.toLocaleString()})]})}),t.jsx("td",{className:"px-4 py-4 text-sm text-gray-900",children:new Date(e.releaseDate).toLocaleDateString()}),t.jsx("td",{className:"px-4 py-4",children:t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e.status})}),t.jsx("td",{className:"px-4 py-4",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{className:"text-gray-400 hover:text-gray-600",title:"Play",children:t.jsx(p,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600",title:"Download",children:t.jsx(y,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600",title:"Share",children:t.jsx(f,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600",title:"Edit",children:t.jsx(N,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-red-600",title:"Delete",children:t.jsx(v,{className:"h-4 w-4"})})]})})]},e.id))})]})}),t.jsx("div",{className:"lg:hidden",children:t.jsx("div",{className:"p-4 space-y-4",children:H.map(e=>t.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border "+(U.includes(e.id)?"border-purple-200 bg-purple-50":"border-gray-200"),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("button",{onClick:()=>I(e.id),className:"flex-shrink-0 mt-1",children:U.includes(e.id)?t.jsx(h,{className:"h-5 w-5 text-purple-600"}):t.jsx(j,{className:"h-5 w-5 text-gray-400"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx(n,{className:"h-6 w-6 text-purple-600"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),t.jsx("p",{className:"text-sm text-gray-500 truncate",children:e.artist})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.genre}),t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e.status})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3",children:[t.jsxs("div",{children:[t.jsx("span",{className:"font-medium",children:"Duration:"})," ",e.duration]}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium",children:"Plays:"})," ",e.plays.toLocaleString()]}),t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"font-medium",children:"Release:"})," ",new Date(e.releaseDate).toLocaleDateString()]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-1",title:"Play",children:t.jsx(p,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-1",title:"Download",children:t.jsx(y,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-1",title:"Share",children:t.jsx(f,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-1",title:"Edit",children:t.jsx(N,{className:"h-4 w-4"})}),t.jsx("button",{className:"text-gray-400 hover:text-red-600 p-1",title:"Delete",children:t.jsx(v,{className:"h-4 w-4"})})]})]})]})},e.id))})})]})}),0===H.length&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx(n,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tracks found"}),t.jsx("p",{className:"text-gray-500 mb-4",children:k||"all"!==D?"Try adjusting your search or filter criteria.":"You haven't uploaded any tracks yet."}),!k&&"all"===D&&t.jsxs(i,{to:"/dashboard/upload",className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors inline-flex items-center gap-2",children:[t.jsx(n,{className:"h-4 w-4"}),"Upload Your First Track"]})]})]})]})},P=()=>{const{user:d}=e(),{showToast:o}=s(),[x,m]=l.useState(1),[p,u]=l.useState({title:"",artist:"",genre:"",releaseDate:"",coverArt:null,audioFile:null,description:"",tags:"",explicit:!1,isrc:"",upc:""}),[g,h]=l.useState(0),[j,b]=l.useState(!1),[y,f]=l.useState({}),[N,v]=l.useState(!1),[T,P]=l.useState(!1),[U,L]=l.useState({}),M=l.useRef(null),E=l.useRef(null),$=()=>{const e={};if(p.title.trim()||(e.title="Title is required"),p.artist.trim()||(e.artist="Artist name is required"),p.genre||(e.genre="Genre is required"),p.audioFile||(e.audioFile="Audio file is required"),p.audioFile){["audio/mpeg","audio/wav","audio/flac","audio/mp3"].includes(p.audioFile.type)||(e.audioFile="Please upload a valid audio file (MP3, WAV, FLAC)"),p.audioFile.size>104857600&&(e.audioFile="Audio file must be less than 100MB")}if(p.coverArt){["image/jpeg","image/png","image/jpg"].includes(p.coverArt.type)||(e.coverArt="Please upload a valid image file (JPEG, PNG)"),p.coverArt.size>10485760&&(e.coverArt="Cover art must be less than 10MB")}return f(e),0===Object.keys(e).length},R=e=>{const{name:s,value:t,type:a,checked:r,files:l}=e.target;u(e=>({...e,[s]:"checkbox"===a?r:"file"===a?l[0]:t})),y[s]&&f(e=>({...e,[s]:""}))},_=e=>{const s=e.target.files[0];s&&(u(t=>({...t,[e.target.name]:s})),y[e.target.name]&&f(s=>({...s,[e.target.name]:""})))},G=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?v(!0):"dragleave"===e.type&&v(!1)},z=(e,s)=>{if(e.preventDefault(),e.stopPropagation(),v(!1),e.dataTransfer.files&&e.dataTransfer.files[0]){const t=e.dataTransfer.files[0];u(e=>({...e,[s]:t})),y[s]&&f(e=>({...e,[s]:""}))}},q=e=>{u(s=>({...s,[e]:null})),"audioFile"===e?M.current.value="":"coverArt"===e&&(E.current.value="")};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Upload Music"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Share your music with the world"})]}),t.jsx("div",{className:"flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4 lg:space-x-8",children:[1,2,3].map(e=>t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium "+(x>=e?"bg-purple-600 text-white":"bg-gray-200 text-gray-600"),children:e}),t.jsx("span",{className:"ml-2 text-sm hidden sm:block "+(x>=e?"text-purple-600 font-medium":"text-gray-500"),children:1===e?"Track Info":2===e?"Upload Files":"Review & Submit"}),e<3&&t.jsx("div",{className:"w-8 sm:w-16 h-0.5 ml-2 sm:ml-4 "+(x>e?"bg-purple-600":"bg-gray-200")})]},e))}),t.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[1===x&&t.jsxs("form",{onSubmit:e=>{e.preventDefault(),1===x?$()&&m(2):2===x&&$()&&m(3)},className:"space-y-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Track Information"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Track Title *"}),t.jsx("input",{type:"text",name:"title",value:p.title,onChange:R,required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(y.title?"border-red-300":"border-gray-300"),placeholder:"Enter track title"}),y.title&&t.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[t.jsx(w,{className:"h-4 w-4"}),y.title]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artist Name *"}),t.jsx("input",{type:"text",name:"artist",value:p.artist,onChange:R,required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(y.artist?"border-red-300":"border-gray-300"),placeholder:"Enter artist name"}),y.artist&&t.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[t.jsx(w,{className:"h-4 w-4"}),y.artist]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Genre *"}),t.jsxs("select",{name:"genre",value:p.genre,onChange:R,required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent "+(y.genre?"border-red-300":"border-gray-300"),children:[t.jsx("option",{value:"",children:"Select genre"}),["Electronic","Pop","Rock","Hip-Hop","R&B","Jazz","Classical","Country","Folk","Ambient","Synthwave","House","Techno","Gospel","Other"].map(e=>t.jsx("option",{value:e,children:e},e))]}),y.genre&&t.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[t.jsx(w,{className:"h-4 w-4"}),y.genre]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Release Date"}),t.jsx("input",{type:"date",name:"releaseDate",value:p.releaseDate,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),t.jsx("textarea",{name:"description",value:p.description,onChange:R,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Describe your track..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),t.jsx("input",{type:"text",name:"tags",value:p.tags,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter tags separated by commas"})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",name:"explicit",checked:p.explicit,onChange:R,className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),t.jsx("label",{className:"ml-2 block text-sm text-gray-700",children:"This track contains explicit content"})]}),t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{type:"submit",className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Next: Upload Files"})})]}),2===x&&t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),$())if(d){b(!0),h(0);try{const e=Date.now(),s=d.id;if(p.audioFile){h(10);const t=`tracks/${s}/${e}_${p.audioFile.name}`,{data:a,error:l}=await r.uploadFile("music-files",p.audioFile,t);if(l)throw new Error(`Audio upload failed: ${l.message}`);L(e=>({...e,audioUrl:a.path})),h(50)}let t=null;if(p.coverArt){h(60);const a=`covers/${s}/${e}_${p.coverArt.name}`,{data:l,error:i}=await r.uploadFile("music-files",p.coverArt,a);i||(t=l.path,L(e=>({...e,coverUrl:l.path}))),h(70)}h(80);const l={title:p.title,artist:p.artist,genre:p.genre,release_date:p.releaseDate||null,description:p.description||null,tags:p.tags?p.tags.split(",").map(e=>e.trim()):[],explicit:p.explicit,isrc:p.isrc||null,upc:p.upc||null,audio_url:U.audioUrl,cover_art_url:t,status:"pending",user_id:s,file_size:p.audioFile?.size||0,duration:null},{data:i,error:c}=await a.createTrack(l);if(c)throw new Error(`Failed to create track record: ${c.message}`);h(100),o("Track uploaded successfully! It will be reviewed before going live.","success"),m(3)}catch(s){o(`Upload failed: ${s.message}`,"error"),U.audioUrl&&await r.deleteFile("music-files",U.audioUrl),U.coverUrl&&await r.deleteFile("music-files",U.coverUrl)}finally{b(!1)}}else o("Please log in to upload music","error")},className:"space-y-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Upload Files"}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Audio File *"}),t.jsxs("div",{className:`border-2 border-dashed rounded-lg p-4 sm:p-6 text-center transition-colors ${N?"border-purple-400 bg-purple-50":"border-gray-300"} ${y.audioFile?"border-red-300":""}`,onDragEnter:G,onDragLeave:G,onDragOver:G,onDrop:e=>z(e,"audioFile"),children:[t.jsx(k,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-3 sm:mb-4"}),t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drop your audio file here or click to browse"}),t.jsx("p",{className:"text-xs text-gray-500 mb-3 sm:mb-4",children:"Supports MP3, WAV, FLAC (max 100MB)"}),t.jsx("input",{ref:M,type:"file",name:"audioFile",onChange:_,accept:"audio/*",required:!0,className:"hidden",id:"audio-upload"}),t.jsx("label",{htmlFor:"audio-upload",className:"bg-purple-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors cursor-pointer text-sm sm:text-base",children:"Choose Audio File"}),p.audioFile&&t.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[t.jsx(C,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),t.jsx("span",{className:"text-sm text-green-800 truncate",children:p.audioFile.name})]}),t.jsx("button",{type:"button",onClick:()=>q("audioFile"),className:"text-red-600 hover:text-red-700 flex-shrink-0 ml-2",children:t.jsx(D,{className:"h-4 w-4"})})]}),t.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[(p.audioFile.size/1048576).toFixed(2)," MB"]})]})]}),y.audioFile&&t.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[t.jsx(w,{className:"h-4 w-4"}),y.audioFile]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cover Art"}),t.jsxs("div",{className:`border-2 border-dashed rounded-lg p-4 sm:p-6 text-center transition-colors ${N?"border-purple-400 bg-purple-50":"border-gray-300"} ${y.coverArt?"border-red-300":""}`,onDragEnter:G,onDragLeave:G,onDragOver:G,onDrop:e=>z(e,"coverArt"),children:[t.jsx(S,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-3 sm:mb-4"}),t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Drop your cover art here or click to browse"}),t.jsx("p",{className:"text-xs text-gray-500 mb-3 sm:mb-4",children:"Supports JPEG, PNG (max 10MB)"}),t.jsx("input",{ref:E,type:"file",name:"coverArt",onChange:_,accept:"image/*",className:"hidden",id:"cover-upload"}),t.jsx("label",{htmlFor:"cover-upload",className:"bg-purple-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors cursor-pointer text-sm sm:text-base",children:"Choose Cover Art"}),p.coverArt&&t.jsxs("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[t.jsx(C,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),t.jsx("span",{className:"text-sm text-green-800 truncate",children:p.coverArt.name})]}),t.jsx("button",{type:"button",onClick:()=>q("coverArt"),className:"text-red-600 hover:text-red-700 flex-shrink-0 ml-2",children:t.jsx(D,{className:"h-4 w-4"})})]}),t.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[(p.coverArt.size/1048576).toFixed(2)," MB"]})]})]}),y.coverArt&&t.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[t.jsx(w,{className:"h-4 w-4"}),y.coverArt]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ISRC Code"}),t.jsx("input",{type:"text",name:"isrc",value:p.isrc,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter ISRC code"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"UPC Code"}),t.jsx("input",{type:"text",name:"upc",value:p.upc,onChange:R,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter UPC code"})]})]}),(p.audioFile||p.coverArt)&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Preview"}),t.jsxs("button",{type:"button",onClick:()=>P(!T),className:"text-sm text-purple-600 hover:text-purple-700 flex items-center gap-1",children:[T?t.jsx(F,{className:"h-4 w-4"}):t.jsx(c,{className:"h-4 w-4"}),T?"Hide":"Show"," Preview"]})]}),T&&t.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-lg flex items-center justify-center",children:p.coverArt?t.jsx("img",{src:URL.createObjectURL(p.coverArt),alt:"Cover",className:"w-full h-full object-cover rounded-lg"}):t.jsx(n,{className:"h-8 w-8 text-purple-600"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h4",{className:"font-medium text-gray-900",children:p.title||"Track Title"}),t.jsx("p",{className:"text-sm text-gray-600",children:p.artist||"Artist Name"}),t.jsx("p",{className:"text-xs text-gray-500",children:p.genre||"Genre"})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("p",{className:"text-sm text-gray-600",children:p.duration||"0:00"}),t.jsx("p",{className:"text-xs text-gray-500",children:p.releaseDate||"Release Date"})]})]})})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3 sm:gap-0",children:[t.jsx("button",{type:"button",onClick:()=>m(1),className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors order-2 sm:order-1",children:"Back"}),t.jsx("button",{type:"submit",disabled:!p.audioFile,className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed order-1 sm:order-2",children:"Upload Track"})]})]}),3===x&&t.jsx("div",{className:"text-center py-8",children:j?t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto",children:t.jsx(A,{className:"h-10 w-10 text-purple-600 animate-bounce"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Uploading your track..."}),t.jsx("p",{className:"text-gray-600",children:"Please don't close this page while uploading"})]}),t.jsxs("div",{className:"max-w-md mx-auto",children:[t.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[t.jsx("span",{children:"Upload Progress"}),t.jsxs("span",{children:[g,"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:t.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${g}%`}})}),t.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[g<30&&"Preparing files...",g>=30&&g<70&&"Uploading audio...",g>=70&&g<90&&"Processing metadata...",g>=90&&g<100&&"Finalizing upload...",100===g&&"Upload complete!"]})]})]}):t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto",children:t.jsx(C,{className:"h-8 w-8 text-green-600"})}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upload Successful!"}),t.jsx("p",{className:"text-gray-600",children:"Your track has been uploaded and is being processed."}),t.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 sm:gap-4",children:[t.jsx("button",{onClick:()=>{m(1),u({title:"",artist:"",genre:"",releaseDate:"",coverArt:null,audioFile:null,description:"",tags:"",explicit:!1,isrc:"",upc:""})},className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"Upload Another Track"}),t.jsx(i,{to:"/dashboard/music",className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors inline-block text-center",children:"View My Music"})]})]})})]})]})};export{T as M,P as U};
